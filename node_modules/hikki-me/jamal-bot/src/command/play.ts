import { Youtube } from '../lib/api/youtube'
import { ICommand, IMessage } from '../Types'

export let handler: ICommand = async (m: IMessage, { args, jamal }): Promise<any> => {
  const query = args.join(' ')
  if (!query) return m.reply('please provide a query')
  const data = await Youtube.search(query)
  if (!data.videos.length) m.reply('no results')
  let menu = '*( 📌 Youtube Play 📌 )*\n\n'
  menu += '*🔖 Title:* ' + data.videos[0].title + '\n'
  menu += '*🔗 URL:* ' + data.videos[0].url + '\n'
  menu += '*📝 Description:* ' + data.videos[0].description + '\n'
  menu += '*⏱ Duration:* ' + data.videos[0].duration.toString() + '\n'
  menu += '*📲 Views:* ' + data.videos[0].views + '\n'
  menu += '*📍 Uploaded:* ' + data.videos[0].ago + '\n'
  menu += '*🎫 Author:* ' + data.videos[0].author + '\n'
  menu += '\n\n( 📌 JAMAL BOT 📌 )'
  jamal.sendTWithUrlButton(m.chat, true, menu, 'pilih format media', ['Show Video ✨', data.videos[0].url, 'VIDEO 💾', '.ytmp4 ' + data.videos[0].url, 'AUDIO 💾', '.ytmp3 ' + data.videos[0].url], null, data.videos[0].thumbnail)
}
handler.command = /^(play|putar)$/i
handler.help = ['play', 'putar'].map((x) => `${x} <query>`)
handler.tags = ['downloader']
