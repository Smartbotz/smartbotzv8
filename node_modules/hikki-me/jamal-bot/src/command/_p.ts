import { ICommand, IMessage } from '../Types'
import { toBuffer } from '../Utils'

export let handler: ICommand = async (m: IMessage, {}) => {
  if (m.type == 'messageContextInfo' || m.type == 'buttonsResponseMessage' || (m.type == 'templateButtonReplyMessage' && m.text.startsWith('http'))) {
    let q = m.quoted?.getMessage() || undefined
    if (!q) return
    if (!q.key.fromMe) return
    const data = await toBuffer(m.text)
    m.reply(data.buffer)
  }
}

handler.isEvent = true
